var __extends=this.__extends||function(f,a){for(var e in a){if(a.hasOwnProperty(e)){f[e]=a[e]}}function c(){this.constructor=f}c.prototype=a.prototype;f.prototype=new c()};define(["require","exports"],function(d,e){var a=(function(){function j(){this.xhr=new XMLHttpRequest();this.promise=new g();this.requestManager=new h(this)}j.prototype.resume=function(k){if(k==="resolve"&&this.promise[k]!==undefined){this.promise[k](this.response)}if(k==="reject"&&this.promise[k]!==undefined){this.promise[k](this.xhr.statusText,this.xhr.status)}};j.prototype.start=function(){this.requestManager.process();return this.promise};j.prototype.restart=function(){this.requestManager.process();return this.promise};return j})();e.Request=a;var c=(function(j){__extends(k,j);function k(l,m){j.call(this);this.type="GET";if(l===undefined){throw new Error("Parameters mismatched")}this.url=l;m===undefined?this.async=true:this.async=false}return k})(a);e.Get=c;var b=(function(k){__extends(j,k);function j(l,n,m){k.call(this);this.type="POST";if(l===undefined||n===undefined){throw new Error("Parameters mismatched")}m===undefined?this.async=true:this.async=false;this.url=l;this.data=n;return this}return j})(a);e.Post=b;var f=(function(k){__extends(j,k);function j(l,n,m){k.call(this);this.type="PUT";if(l===undefined||n===undefined){throw new Error("Parameters mismatched")}m===undefined?this.async=true:this.async=false;this.url=l;this.data=n;return this}return j})(a);e.Put=f;var i=(function(k){__extends(j,k);function j(l,n,m){k.call(this);this.type="DELETE";if(l===undefined||n===undefined){throw new Error("Parameters mismatched")}m===undefined?this.async=true:this.async=false;this.url=l;this.data=n;return this}return j})(a);e.Delete=i;var h=(function(){function j(k){this.request=k}j.prototype.verifyStatus=function(){return !(this.request.xhr.status<200||this.request.xhr.status>=300&&this.request.xhr.status!==304)};j.prototype.statedChanged=function(){if(this.verifyStatus()){return this.parseData()}return this.request.resume.call(this.request,"reject")};j.prototype.parseData=function(){if(this.request.xhr.getResponseHeader("content-type")=="application/json"){this.request.response=JSON.parse(this.request.xhr.response)}else{this.request.response=this.request.xhr.response}return this.request.resume.call(this.request,"resolve")};j.prototype.process=function(){this.request.xhr.open(this.request.type,this.request.url,this.request.async);this.request.xhr.onload=this.statedChanged.bind(this);this.request.xhr.send(this.prepareData())};j.prototype.prepareData=function(){if(typeof(this.request.data)==="object"){this.request.xhr.setRequestHeader("Content-Type","application/json");return JSON.stringify(this.request.data)}if(typeof(this.request.data)==="string"){return this.request.data}return null};return j})();e.RequestManager=h;var g=(function(){function j(){}j.prototype.fail=function(k){this.reject=k};j.prototype.then=function(l,k){this.resolve=l;k!==undefined?this.reject=k:false};return j})();e.Promise=g});